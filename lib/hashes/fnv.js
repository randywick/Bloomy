'use strict';

/**
 * @see {@link http://www.isthe.com/chongo/tech/comp/fnv/#FNV-param}
 */
exports = module.exports;


exports.FNV_PRIME_32 = 16777619;
exports.FNV_PRIME_64 = 1099511628211;
exports.FNV_PRIME_128 = 309485009821345068724781371;
exports.FNV_PRIME_256 = 374144419156711147060143317175368453031918731002211;
exports.FNV_PRIME_512 = 35835915874844867368919076489095108449946327955754392558399825615420669938882575126094039892345713852759;
exports.FNV_PRIME_1024 = 5016456510113118655434598811035278955030765345404790744303017523831112055108147451509157692220295382716162651878526895249385292291816524375083746691371804094271873160484737966720260389217684476157468082573;



exports.FNV_OFFSET_BASIS_32 = 2166136261;
exports.FNV_OFFSET_BASIS_64 = 14695981039346656037;
exports.FNV_OFFSET_BASIS_128 = 144066263297769815596495629667062367629;
exports.FNV_OFFSET_BASIS_256 = 100029257958052580907070968620625704837092796014241193945225284501741471925557;
exports.FNV_OFFSET_BASIS_512 = 9659303129496669498009435400716310466090418745672637896108374329434462657994582932197716438449813051892206539805784495328239340083876191928701583869517785;
exports.FNV_OFFSET_BASIS_1024 = 14197795064947621068722070641403218320880622795441933960878474914617582723252296732303717722150864096521202355549365628174669108571814760471015076148029755969804077320157692458563003215304957150157403644460363550505412711285966361610267868082893823963790439336411086884584107735010676915;


/**
 * Generates the FNV-1a hash of the provided value
 *
 * @param {string} value     - the message to hash
 *
 * Example:
 * 1197969230
 * 1682002281
 * 23350270
 * 1086759538
 * 1389291240
 * 969466606
 * 2072905904
 * 475460055
 * 1981809703
 *
 * @returns {number}
 */
function hash(value) {
  const bits = 32;
  const prime = exports[`FNV_PRIME_${bits}`];
  const offset = exports[`FNV_OFFSET_BASIS_${bits}`];

  let hash = value.split('').reduce((hash, char) => {
    hash ^= (char.charCodeAt(0) & 0xff);
    return hash * prime
  }, offset);

  if (hash < 0) hash *= -1;
  return hash % 2142779559;
}

exports.hash = hash;